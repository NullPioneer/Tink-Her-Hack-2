<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>KeralaSeva AI â€” Scholarship Navigator</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
<style>
  /* CHATBOT */
#chat-toggle {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #123524;
  color: white;
  width: 55px;
  height: 55px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
  cursor: pointer;
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  z-index: 9999;
}

#chatbox {
  position: fixed;
  bottom: 90px;
  right: 20px;
  width: 340px;
  height: 450px;
  background: white;
  border-radius: 14px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.3);
  display: none;
  flex-direction: column;
  overflow: hidden;
  z-index: 9999;
}

.chat-header {
  background: #123524;
  color: white;
  padding: 12px;
  font-weight: 600;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

#chat-messages {
  flex: 1;
  padding: 12px;
  overflow-y: auto;
  font-size: 14px;
}

.chat-message {
  margin-bottom: 10px;
  line-height: 1.4;
}

.chat-user {
  text-align: right;
  color: #123524;
  font-weight: 500;
}

.chat-ai {
  text-align: left;
  color: #333;
}

.chat-input-area {
  display: flex;
  border-top: 1px solid #ddd;
}

.chat-input-area input {
  flex: 1;
  padding: 10px;
  border: none;
  outline: none;
}

.chat-input-area button {
  background: #D4A840;
  border: none;
  padding: 10px 15px;
  cursor: pointer;
  font-weight: 600;
}
  /* â”€â”€â”€â”€â”€ SIDEBAR â”€â”€â”€â”€â”€ */
.sidebar {
  position: fixed;
  top: 0;
  left: -280px;
  width: 260px;
  height: 100%;
  background: var(--forest);
  color: #fff;
  z-index: 1000;
  transition: left 0.3s ease;
  box-shadow: 4px 0 20px rgba(0,0,0,.2);
}

.sidebar.open {
  left: 0;
}

.sidebar-inner {
  padding: 24px;
}

.sb-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  font-weight: 600;
  color: var(--gold-lt);
}

.sb-close {
  background: transparent;
  border: none;
  color: #fff;
  font-size: 18px;
  cursor: pointer;
}

.sb-item {
  padding: 12px 10px;
  border-radius: 8px;
  cursor: pointer;
  margin-bottom: 8px;
  transition: background .2s;
}

.sb-item:hover {
  background: rgba(255,255,255,.1);
}

.sidebar-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.4);
  display: none;
  z-index: 999;
}

.sidebar-overlay.show {
  display: block;
}

.menu-icon {
  font-size: 22px;
  cursor: pointer;
  color: var(--gold-lt);
  padding: 6px 10px;
}
/* â”€â”€ RESET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --forest:#123524; --forest-mid:#1E4D35; --forest-lt:#2A6645;
  --cream:#F7F2E8;  --parch:#EDE5D0;      --white:#FDFAF4;
  --gold:#D4A840;   --gold-lt:#F2CB6A;
  --terra:#B84C38;  --terra-lt:#E06652;
  --ink:#0D1B12;    --muted:#7A7060;      --border:#D6CCBA;
  --sage:#7BAE8A;
  --sh:0 4px 24px rgba(13,27,18,.1);
  --sh-lg:0 16px 56px rgba(13,27,18,.16);
}
html{scroll-behavior:smooth}
body{font-family:'Outfit',sans-serif;background:var(--cream);color:var(--ink);overflow-x:hidden}
h1,h2,h3,h4{font-family:'Cormorant Garamond',serif;line-height:1.08}
p{line-height:1.72}
button,input,select,textarea{font-family:'Outfit',sans-serif}
a{text-decoration:none;color:inherit}

/* â”€â”€ PAGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.pg{display:none;animation:pgIn .42s cubic-bezier(.22,.68,0,1.15) both}
.pg.on{display:block}
@keyframes pgIn{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
.pw{padding-top:66px;min-height:calc(100vh - 66px)}

/* â”€â”€ NAVBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
nav{position:fixed;top:0;left:0;right:0;z-index:600;height:66px;
  background:rgba(18,53,36,.97);backdrop-filter:blur(18px);
  display:flex;align-items:center;justify-content:space-between;padding:0 52px;
  border-bottom:1px solid rgba(255,255,255,.07)}
.logo{font-family:'Cormorant Garamond',serif;font-size:23px;font-weight:700;
  color:var(--gold-lt);cursor:pointer;display:flex;align-items:center;gap:9px}
.logo-dot{width:8px;height:8px;border-radius:50%;background:var(--gold);
  box-shadow:0 0 10px var(--gold);animation:glow 2.5s ease-in-out infinite}
@keyframes glow{0%,100%{opacity:1}50%{opacity:.3}}
#nav-r{display:flex;align-items:center;gap:6px}
.nl{color:rgba(255,255,255,.65);font-size:14px;font-weight:500;padding:7px 14px;
  border-radius:7px;cursor:pointer;transition:all .2s}
.nl:hover,.nl.on{color:var(--gold-lt);background:rgba(255,255,255,.06)}
.nl-cta{background:var(--gold);color:var(--forest);padding:9px 22px;
  border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;transition:all .2s}
.nl-cta:hover{background:var(--gold-lt);transform:translateY(-1px)}
.nav-avatar{width:34px;height:34px;border-radius:50%;
  background:linear-gradient(135deg,var(--forest-lt),var(--sage));
  display:flex;align-items:center;justify-content:center;
  font-weight:700;font-size:13px;color:#fff;border:2px solid rgba(255,255,255,.2)}
.nav-logout{color:rgba(255,255,255,.5);font-size:13px;cursor:pointer;padding:6px 12px;
  border-radius:6px;transition:all .2s;border:1px solid rgba(255,255,255,.12);background:transparent}
.nav-logout:hover{color:var(--terra-lt);border-color:rgba(224,102,82,.3)}

/* â”€â”€ SHARED COMPONENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;
  padding:13px 28px;border-radius:10px;font-size:15px;font-weight:600;
  cursor:pointer;transition:all .22s;border:none;letter-spacing:.1px}
.btn-forest{background:var(--forest);color:#fff}
.btn-forest:hover{background:var(--forest-mid);transform:translateY(-2px);box-shadow:var(--sh)}
.btn-gold{background:var(--gold);color:var(--forest)}
.btn-gold:hover{background:var(--gold-lt);transform:translateY(-2px);box-shadow:0 8px 24px rgba(212,168,64,.35)}
.btn-ghost{background:transparent;color:rgba(255,255,255,.82);border:1.5px solid rgba(255,255,255,.28)}
.btn-ghost:hover{border-color:var(--gold-lt);color:var(--gold-lt)}
.btn-red{background:var(--terra);color:#fff}
.btn-red:hover{background:var(--terra-lt);transform:translateY(-1px)}
.btn-sm{padding:9px 18px;font-size:13px;border-radius:8px}
.btn-outline{background:transparent;border:1.5px solid var(--forest);color:var(--forest)}
.btn-outline:hover{background:var(--forest);color:#fff}

.tag{display:inline-block;font-size:11px;font-weight:600;padding:3px 11px;border-radius:100px}
.t-sage{background:#E3F0E8;color:var(--forest-lt)}
.t-muted{background:#EDE9E1;color:var(--muted)}
.t-red{background:#FBE9E6;color:var(--terra)}
.t-urg{background:var(--terra);color:#fff;animation:upulse 2s ease-in-out infinite}
@keyframes upulse{0%,100%{box-shadow:0 0 0 0 rgba(184,76,56,.5)}50%{box-shadow:0 0 0 8px rgba(184,76,56,0)}}

.spin{width:40px;height:40px;border-radius:50%;border:3px solid var(--parch);
  border-top-color:var(--gold);animation:rot .8s linear infinite;margin:0 auto}
@keyframes rot{to{transform:rotate(360deg)}}
.spin-wrap{display:flex;flex-direction:column;align-items:center;gap:14px;padding:90px 20px}
.spin-txt{font-size:14px;color:var(--muted)}

.msg{border-radius:10px;padding:13px 18px;font-size:13.5px;line-height:1.55;
  display:flex;align-items:flex-start;gap:10px;margin-bottom:16px}
.msg-ok {background:#E8F5EF;border:1px solid #A8D9BB;color:#1B5E38}
.msg-err{background:#FBE9E6;border:1px solid #F5BCB4;color:#7A1E10}
.msg-inf{background:#EAF3FF;border:1px solid #B8D6F5;color:#174880}
.msg-wrn{background:#FEF9EE;border:1px solid #F5E2A8;color:#7A5B10}

/* â”€â”€ FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
footer{background:var(--forest);padding:26px 56px;
  display:flex;justify-content:space-between;align-items:center;
  border-top:1px solid rgba(255,255,255,.07)}
.foot-logo{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:700;color:var(--gold-lt)}
.foot-copy{font-size:12px;color:rgba(255,255,255,.38)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 1 â€“ LANDING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero{background:var(--forest);min-height:calc(100vh - 66px);
  display:grid;grid-template-columns:1.1fr 1fr;position:relative;overflow:hidden}
.hero-bg{position:absolute;inset:0;pointer-events:none;
  background:
    radial-gradient(ellipse 60% 70% at 75% 20%,rgba(212,168,64,.09),transparent 60%),
    radial-gradient(ellipse 50% 60% at 15% 80%,rgba(42,102,69,.35),transparent 55%)}
.hero-grid{position:absolute;inset:0;pointer-events:none;
  background-image:
    repeating-linear-gradient(0deg,rgba(255,255,255,.022) 0,rgba(255,255,255,.022) 1px,transparent 1px,transparent 64px),
    repeating-linear-gradient(90deg,rgba(255,255,255,.022) 0,rgba(255,255,255,.022) 1px,transparent 1px,transparent 64px)}
.hero-l{display:flex;flex-direction:column;justify-content:center;
  padding:80px 72px;position:relative;z-index:2}
.hero-pill{display:inline-flex;align-items:center;gap:8px;
  background:rgba(212,168,64,.14);border:1px solid rgba(212,168,64,.3);
  color:var(--gold-lt);font-size:11px;font-weight:700;letter-spacing:2.5px;
  text-transform:uppercase;padding:7px 16px;border-radius:100px;
  width:fit-content;margin-bottom:28px;animation:fadeUp .6s ease both}
.hero-title{font-size:clamp(44px,5.5vw,72px);font-weight:700;color:#fff;line-height:1.03;
  margin-bottom:24px;animation:fadeUp .6s .1s ease both}
.hero-title .acc{color:var(--gold-lt);font-style:italic}
.hero-desc{font-size:17px;color:rgba(255,255,255,.64);line-height:1.8;
  max-width:460px;margin-bottom:44px;animation:fadeUp .6s .2s ease both}
.hero-acts{display:flex;gap:14px;flex-wrap:wrap;animation:fadeUp .6s .3s ease both}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.hero-r{display:flex;align-items:center;justify-content:center;padding:60px 40px;position:relative;z-index:2}
.card-stack{position:relative;width:320px;height:370px}
.fc{position:absolute;left:0;right:0;background:rgba(255,255,255,.07);
  border:1px solid rgba(255,255,255,.14);border-radius:18px;padding:24px 26px;backdrop-filter:blur(10px)}
.fc:nth-child(1){top:0;animation:f1 7s ease-in-out infinite}
.fc:nth-child(2){top:128px;left:18px;right:-18px;animation:f2 7s 1.2s ease-in-out infinite}
.fc:nth-child(3){top:254px;left:36px;right:-36px;animation:f1 7s 2.4s ease-in-out infinite}
@keyframes f1{0%,100%{transform:translateY(0)}50%{transform:translateY(-12px)}}
@keyframes f2{0%,100%{transform:translateY(0) rotate(-.8deg)}50%{transform:translateY(-9px) rotate(.8deg)}}
.fc-cat{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--gold-lt);margin-bottom:7px}
.fc-name{font-family:'Cormorant Garamond',serif;font-size:16px;color:#fff;margin-bottom:9px;line-height:1.3}
.fc-amt{font-size:22px;font-weight:700;color:var(--gold-lt)}
.fc-meta{font-size:11px;color:rgba(255,255,255,.4);margin-top:4px}
.fc-bar{height:2px;background:rgba(255,255,255,.1);border-radius:2px;margin-top:12px}
.fc-fill{height:100%;border-radius:2px;background:linear-gradient(90deg,var(--gold),var(--gold-lt))}

.stats-strip{background:var(--gold);padding:28px 80px;
  display:flex;justify-content:space-around;align-items:center;gap:24px;flex-wrap:wrap}
.stat-n{font-family:'Cormorant Garamond',serif;font-size:44px;font-weight:700;color:var(--forest);line-height:1}
.stat-l{font-size:12px;color:rgba(13,27,18,.65);font-weight:600;margin-top:3px;letter-spacing:.5px}

.sec{padding:100px 80px}
.sec-label{font-size:11px;font-weight:700;letter-spacing:3px;text-transform:uppercase;
  color:var(--gold);margin-bottom:10px}
.sec-title{font-size:clamp(30px,5vw,52px);font-weight:700;color:var(--forest);line-height:1.05}
.sec-sub{font-size:16px;color:var(--muted);max-width:520px;line-height:1.75;margin-top:14px}

.feat-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:22px;margin-top:56px}
.feat-c{background:var(--white);border:1px solid var(--border);border-radius:18px;
  padding:36px 28px;transition:all .3s;position:relative;overflow:hidden}
.feat-c::after{content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(42,102,69,.04),transparent 60%);
  opacity:0;transition:opacity .3s}
.feat-c:hover{transform:translateY(-5px);box-shadow:var(--sh-lg);border-color:var(--sage)}
.feat-c:hover::after{opacity:1}
.feat-ico{width:52px;height:52px;border-radius:14px;
  background:linear-gradient(135deg,var(--forest),var(--forest-lt));
  display:flex;align-items:center;justify-content:center;font-size:24px;margin-bottom:20px}
.feat-title{font-family:'Cormorant Garamond',serif;font-size:22px;color:var(--forest);margin-bottom:10px;font-weight:700}
.feat-desc{font-size:14px;color:var(--muted);line-height:1.7}

.how-bg{background:var(--forest);position:relative;overflow:hidden}
.how-bg::before{content:'';position:absolute;inset:0;pointer-events:none;
  background:radial-gradient(ellipse 70% 50% at 50% 0%,rgba(212,168,64,.07),transparent 60%)}
.steps-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0;margin-top:64px;position:relative;z-index:1}
.steps-grid::before{content:'';position:absolute;top:30px;left:12%;right:12%;height:1px;
  background:linear-gradient(90deg,transparent,rgba(212,168,64,.4),transparent)}
.step{text-align:center;padding:0 14px}
.step-n{width:60px;height:60px;border-radius:50%;background:var(--gold);
  display:flex;align-items:center;justify-content:center;
  font-family:'Cormorant Garamond',serif;font-size:26px;font-weight:700;color:var(--forest);
  margin:0 auto 22px;position:relative;z-index:1;transition:transform .3s}
.step:hover .step-n{transform:scale(1.1)}
.step-t{font-family:'Cormorant Garamond',serif;font-size:20px;color:#fff;margin-bottom:10px}
.step-d{font-size:13px;color:rgba(255,255,255,.52);line-height:1.65}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 2 â€“ ALL SCHOLARSHIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ph{background:var(--forest);padding:110px 80px 90px;position:relative;overflow:hidden}
.ph::after{content:'';position:absolute;bottom:-2px;left:0;right:0;height:58px;
  background:var(--cream);clip-path:ellipse(50% 100% at 50% 100%)}
.ph-bg{position:absolute;inset:0;pointer-events:none;
  background:radial-gradient(ellipse 55% 60% at 85% 30%,rgba(212,168,64,.1),transparent 55%)}
.ph-inner{position:relative;z-index:1}
.ph-title{font-size:clamp(36px,5vw,62px);font-weight:700;color:#fff;margin-bottom:16px}
.ph-sub{font-size:17px;color:rgba(255,255,255,.6);max-width:550px;line-height:1.75}

.p2-main{padding:80px 80px 100px}
.filt-bar{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:44px}
.fb{padding:8px 20px;border-radius:100px;border:1.5px solid var(--border);background:var(--white);
  font-family:'Outfit',sans-serif;font-size:13px;font-weight:500;color:var(--muted);cursor:pointer;transition:all .2s}
.fb.on,.fb:hover{background:var(--forest);border-color:var(--forest);color:#fff}

.s-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:60px}
.s-card{background:var(--white);border:1px solid var(--border);border-radius:16px;
  padding:24px;cursor:pointer;transition:all .25s;position:relative;overflow:hidden}
.s-card::before{content:'';position:absolute;bottom:0;left:0;right:0;height:3px;
  background:linear-gradient(90deg,var(--gold),var(--gold-lt));
  transform:scaleX(0);transition:transform .3s;transform-origin:left}
.s-card:hover{box-shadow:var(--sh-lg);transform:translateY(-3px);border-color:var(--sage)}
.s-card:hover::before{transform:scaleX(1)}
.sc-cat{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:8px}
.sc-name{font-family:'Cormorant Garamond',serif;font-size:19px;color:var(--forest);margin-bottom:10px;line-height:1.3}
.sc-amt{font-size:21px;font-weight:700;color:var(--ink);margin-bottom:12px}
.sc-foot{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}
.sc-dl{font-size:12px;color:var(--muted);display:flex;align-items:center;gap:4px}
.sc-dl.soon{color:var(--terra);font-weight:600}

.cta-block{background:linear-gradient(130deg,var(--forest),var(--forest-mid));
  border-radius:20px;padding:52px 60px;
  display:flex;justify-content:space-between;align-items:center;gap:40px}
.cta-l h2{font-size:36px;color:#fff;margin-bottom:12px}
.cta-l p{color:rgba(255,255,255,.65);font-size:15px;max-width:460px;line-height:1.7}
.cta-r{display:flex;flex-direction:column;gap:12px;min-width:220px}
.cta-btn{display:flex;align-items:center;gap:10px;padding:14px 22px;border-radius:10px;
  font-family:'Outfit',sans-serif;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s;border:none}
.cta-gold{background:var(--gold);color:var(--forest)}
.cta-gold:hover{background:var(--gold-lt)}
.cta-ghost{background:rgba(255,255,255,.1);color:#fff;border:1px solid rgba(255,255,255,.18)}
.cta-ghost:hover{background:rgba(255,255,255,.18)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 3 â€“ AUTH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.auth-wrap{min-height:calc(100vh - 66px);display:grid;grid-template-columns:1fr 1fr}
.auth-l{background:var(--forest);padding:80px 64px;
  display:flex;flex-direction:column;justify-content:center;position:relative;overflow:hidden}
.auth-l-bg{position:absolute;inset:0;pointer-events:none;
  background:radial-gradient(ellipse 60% 50% at 80% 20%,rgba(212,168,64,.12),transparent 55%),
             radial-gradient(ellipse 50% 60% at 15% 85%,rgba(42,102,69,.3),transparent 50%)}
.auth-l-in{position:relative;z-index:1}
.auth-l-in h2{font-size:46px;color:#fff;margin-bottom:18px}
.auth-l-in h2 .g{color:var(--gold-lt);font-style:italic}
.auth-l-in > p{color:rgba(255,255,255,.6);font-size:15px;line-height:1.8;margin-bottom:36px;max-width:380px}
.ben{display:flex;align-items:flex-start;gap:12px;margin-bottom:14px}
.ben-ico{width:28px;height:28px;border-radius:7px;
  background:rgba(212,168,64,.2);border:1px solid rgba(212,168,64,.3);
  display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;margin-top:1px}
.ben-txt{color:rgba(255,255,255,.75);font-size:14px;line-height:1.6}
.auth-quote{margin-top:44px;padding:22px 24px;
  background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);
  border-radius:14px;border-left:3px solid var(--gold)}
.auth-quote p{color:rgba(255,255,255,.65);font-size:13.5px;font-style:italic;line-height:1.65}
.auth-quote cite{color:var(--gold-lt);font-size:12px;font-style:normal;font-weight:600;margin-top:8px;display:block}

.auth-r{background:var(--cream);display:flex;align-items:center;justify-content:center;padding:60px 64px}
.auth-box{width:100%;max-width:440px}
.tabs-wrap{display:flex;background:#E8E3D8;border-radius:11px;padding:4px;margin-bottom:32px}
.atab{flex:1;text-align:center;padding:11px;border-radius:8px;
  font-family:'Outfit',sans-serif;font-size:14px;font-weight:600;
  cursor:pointer;transition:all .2s;color:var(--muted);border:none;background:transparent}
.atab.on{background:var(--forest);color:#fff;box-shadow:0 2px 10px rgba(18,53,36,.25)}

.fsec{font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;
  color:var(--gold);margin:24px 0 14px;padding-bottom:8px;border-bottom:1px solid var(--border)}
.fg{margin-bottom:17px}
.fl{display:block;font-size:12px;font-weight:600;color:var(--forest);margin-bottom:7px;letter-spacing:.2px}
.fi,.fs{width:100%;padding:12px 14px;border:1.5px solid var(--border);border-radius:9px;
  font-family:'Outfit',sans-serif;font-size:15px;background:var(--white);
  color:var(--ink);transition:border-color .2s;outline:none}
.fi:focus,.fs:focus{border-color:var(--gold)}
.fs{appearance:none;cursor:pointer;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%237A7060' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:right 12px center;padding-right:36px}
.frow{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.sub-btn{width:100%;background:var(--forest);color:#fff;border:none;padding:14px;
  border-radius:10px;font-family:'Outfit',sans-serif;font-size:16px;font-weight:600;
  cursor:pointer;transition:all .2s;margin-top:8px;
  display:flex;align-items:center;justify-content:center;gap:10px}
.sub-btn:hover{background:var(--forest-mid);transform:translateY(-1px);box-shadow:var(--sh)}
.sub-btn:disabled{opacity:.55;cursor:not-allowed;transform:none}
.b-spin{width:18px;height:18px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;
  border-radius:50%;animation:rot .7s linear infinite;display:none}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 4 â€“ MY SCHOLARSHIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.my-hero{background:var(--forest);padding:110px 80px 80px;position:relative;overflow:hidden}
.my-hero-bg{position:absolute;inset:0;pointer-events:none;
  background:radial-gradient(ellipse 60% 50% at 85% 40%,rgba(212,168,64,.1),transparent 55%)}
.my-hero-in{position:relative;z-index:1;display:flex;justify-content:space-between;align-items:flex-end;gap:28px;flex-wrap:wrap}
.my-hero h1{font-size:clamp(34px,5vw,58px);font-weight:700;color:#fff;margin-bottom:10px}
.my-hero h1 .acc{color:var(--gold-lt);font-style:italic}
.my-hero p{font-size:16px;color:rgba(255,255,255,.6);max-width:500px;line-height:1.75}
.my-stat{background:rgba(255,255,255,.09);border:1px solid rgba(255,255,255,.14);
  border-radius:16px;padding:20px 32px;text-align:center;flex-shrink:0}
.ms-n{font-family:'Cormorant Garamond',serif;font-size:42px;font-weight:700;color:var(--gold-lt);line-height:1}
.ms-l{font-size:12px;color:rgba(255,255,255,.55);margin-top:5px}

.p4-main{padding:60px 80px 100px}
.urg-sec{background:linear-gradient(135deg,#FFF1EE,#FDE6E1);
  border:1px solid #F2C0B4;border-radius:18px;padding:28px 32px;margin-bottom:46px}
.urg-hd{display:flex;align-items:center;gap:14px;margin-bottom:20px}
.urg-title{font-family:'Cormorant Garamond',serif;font-size:22px;color:var(--terra)}
.urg-row{display:flex;gap:14px;flex-wrap:wrap}
.urg-card{background:#fff;border:1.5px solid #F2C0B4;border-radius:13px;
  padding:18px 22px;flex:1;min-width:240px;
  display:flex;justify-content:space-between;align-items:center;gap:16px;transition:all .2s}
.urg-card:hover{border-color:var(--terra);box-shadow:0 8px 24px rgba(184,76,56,.12)}
.uc-name{font-weight:600;font-size:15px;color:var(--ink);margin-bottom:5px;line-height:1.3}
.uc-days{display:inline-flex;align-items:center;gap:4px;font-size:12px;font-weight:700;
  color:var(--terra);background:#FBE9E6;padding:3px 10px;border-radius:100px}

.list-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.list-title{font-family:'Cormorant Garamond',serif;font-size:26px;color:var(--forest)}
.count-pill{background:var(--forest);color:#fff;font-size:12px;font-weight:600;padding:4px 14px;border-radius:100px}
.s-list{display:flex;flex-direction:column;gap:13px}
.s-row{background:var(--white);border:1px solid var(--border);border-radius:15px;
  padding:22px 28px;display:grid;grid-template-columns:1fr auto auto;
  align-items:center;gap:22px;transition:all .22s;cursor:pointer}
.s-row:hover{border-color:var(--sage);box-shadow:var(--sh);transform:translateY(-1px)}
.sr-cat{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:5px}
.sr-name{font-family:'Cormorant Garamond',serif;font-size:21px;color:var(--forest);margin-bottom:9px}
.sr-meta{display:flex;gap:18px;align-items:center;flex-wrap:wrap}
.sr-amt{font-weight:700;font-size:16px;color:var(--ink)}
.sr-dl{font-size:13px;color:var(--muted);display:flex;align-items:center;gap:5px}
.sr-dl.soon{color:#9A6010;font-weight:600}
.sr-dl.urg{color:var(--terra);font-weight:700}
.sr-tags{display:flex;gap:6px;flex-wrap:wrap}
.empty{text-align:center;padding:80px 20px}
.empty h3{font-family:'Cormorant Garamond',serif;font-size:28px;color:var(--forest);margin-bottom:10px}
.empty p{color:var(--muted);font-size:15px;max-width:420px;margin:0 auto 28px}
.empty-ico{font-size:52px;margin-bottom:16px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 5 â€“ DETAIL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.p5-main{padding:80px 80px 100px;max-width:1160px;margin:0 auto}
.crumb{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted);margin-bottom:26px;flex-wrap:wrap}
.crumb-lnk{cursor:pointer;transition:color .2s}
.crumb-lnk:hover{color:var(--gold)}
.crumb-sep{color:var(--border)}
.crumb-cur{color:var(--ink);font-weight:600}
.back-btn{display:inline-flex;align-items:center;gap:7px;background:transparent;
  border:1.5px solid var(--border);color:var(--muted);padding:8px 16px;border-radius:8px;
  font-family:'Outfit',sans-serif;font-size:13px;font-weight:500;cursor:pointer;
  transition:all .2s;margin-bottom:20px}
.back-btn:hover{border-color:var(--gold);color:var(--gold)}

.det-hdr{background:linear-gradient(130deg,var(--forest),var(--forest-lt));
  border-radius:22px;padding:48px 52px;margin-bottom:26px;
  display:flex;justify-content:space-between;align-items:flex-start;gap:32px}
.dh-l{flex:1}
.dh-cat{font-size:10px;font-weight:700;letter-spacing:2.5px;text-transform:uppercase;
  color:var(--gold-lt);margin-bottom:12px}
.dh-title{font-size:clamp(26px,4vw,44px);color:#fff;margin-bottom:14px;line-height:1.08}
.dh-desc{font-size:16px;color:rgba(255,255,255,.65);line-height:1.8;max-width:580px;margin-bottom:18px}
.dh-urg{display:inline-flex;align-items:center;gap:8px;
  background:rgba(184,76,56,.25);border:1px solid rgba(184,76,56,.4);
  color:#FFB5A5;font-size:13px;font-weight:700;padding:8px 18px;border-radius:9px}
.dh-amt{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.18);
  border-radius:18px;padding:26px 34px;text-align:center;min-width:210px;flex-shrink:0}
.da-l{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.5);margin-bottom:7px}
.da-v{font-family:'Cormorant Garamond',serif;font-size:36px;font-weight:700;color:var(--gold-lt);line-height:1}
.da-dl{font-size:13px;color:rgba(255,255,255,.5);margin-top:8px}
.da-inc{font-size:11px;color:rgba(255,255,255,.38);margin-top:5px}

.det-grid{display:grid;grid-template-columns:3fr 2fr;gap:22px;margin-bottom:22px}
.d-card{background:var(--white);border:1px solid var(--border);border-radius:18px;padding:32px}
.d-card+.d-card{margin-top:22px}
.dc-hd{display:flex;align-items:center;gap:12px;margin-bottom:24px}
.dc-ico{width:44px;height:44px;border-radius:12px;
  background:linear-gradient(135deg,var(--forest),var(--forest-lt));
  display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0}
.dc-lbl{font-family:'Cormorant Garamond',serif;font-size:22px;color:var(--forest);font-weight:700}

.step-list{list-style:none}
.step-r{display:flex;gap:16px;align-items:flex-start;padding:15px 0;border-bottom:1px solid #F0EBE1}
.step-r:last-child{border-bottom:none}
.step-c{width:36px;height:36px;border-radius:50%;background:var(--gold);
  color:var(--forest);font-weight:700;font-size:14px;
  display:flex;align-items:center;justify-content:center;flex-shrink:0}
.step-txt{font-size:14px;color:var(--ink);line-height:1.7;padding-top:5px}

.doc-list{display:flex;flex-direction:column;gap:9px}
.doc-item{display:flex;align-items:center;gap:12px;background:var(--cream);
  border:1px solid var(--border);border-radius:10px;padding:12px 16px;transition:border-color .2s}
.doc-item:hover{border-color:var(--sage)}
.doc-name{font-size:14px;font-weight:500;color:var(--ink)}
.doc-tip{margin-top:14px;padding:13px 15px;background:#FEF9EE;
  border:1px solid #F5E2A8;border-radius:9px;font-size:13px;color:#7A5B10;line-height:1.6}

.elig-list{display:flex;flex-direction:column;gap:10px}
.elig-chip{background:#EFF8F4;border:1px solid #C0DDD0;border-radius:11px;padding:14px 16px}
.elig-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
.ef-l{font-size:10px;font-weight:700;letter-spacing:1.2px;text-transform:uppercase;color:var(--forest-lt);margin-bottom:3px}
.ef-v{font-size:13px;font-weight:600;color:var(--forest)}
.inc-tag{margin-top:10px;display:flex;align-items:center;gap:8px;
  background:#FBF0D6;border:1px solid #F0D898;border-radius:8px;
  padding:10px 14px;font-size:13px;color:#7A5B10;font-weight:500}

.apply-bar{background:linear-gradient(130deg,var(--gold),var(--gold-lt));
  border-radius:18px;padding:38px 46px;
  display:flex;justify-content:space-between;align-items:center;gap:28px}
.ab-l h3{font-family:'Cormorant Garamond',serif;font-size:26px;color:var(--forest);margin-bottom:8px}
.ab-l p{font-size:14px;color:rgba(13,27,18,.7);line-height:1.7;max-width:500px}
.apply-btn{background:var(--forest);color:#fff;border:none;
  padding:15px 34px;border-radius:11px;
  font-family:'Outfit',sans-serif;font-size:15px;font-weight:700;
  cursor:pointer;transition:all .22s;display:inline-flex;align-items:center;gap:8px;white-space:nowrap}
.apply-btn:hover{background:var(--forest-mid);transform:translateY(-2px);box-shadow:0 10px 30px rgba(18,53,36,.3)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:960px){
  nav{padding:0 20px}
  .hero{grid-template-columns:1fr}
  .hero-r{display:none}
  .hero-l{padding:60px 28px}
  .stats-strip,.sec{padding-left:24px;padding-right:24px}
  .feat-grid{grid-template-columns:1fr 1fr}
  .steps-grid{grid-template-columns:1fr 1fr}
  .steps-grid::before{display:none}
  .ph,.p2-main,.my-hero,.p4-main,.p5-main{padding-left:24px;padding-right:24px}
  .s-grid{grid-template-columns:1fr 1fr}
  .cta-block{flex-direction:column;padding:36px 28px}
  .auth-wrap{grid-template-columns:1fr}
  .auth-l{display:none}
  .auth-r{padding:80px 24px}
  .my-hero-in{flex-direction:column;align-items:flex-start}
  .s-row{grid-template-columns:1fr}
  .sr-tags{display:none}
  .det-hdr{flex-direction:column;padding:32px 28px}
  .dh-amt{min-width:auto;width:100%}
  .det-grid{grid-template-columns:1fr}
  .apply-bar{flex-direction:column;padding:28px 24px}
  footer{flex-direction:column;gap:10px;padding:24px 20px;text-align:center}
}
@media(max-width:600px){.s-grid{grid-template-columns:1fr}.feat-grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<!-- SIDEBAR -->
<div id="sidebar" class="sidebar">
  <div class="sidebar-inner">
    <div class="sb-header">
      <span>Menu</span>
      <button class="sb-close" onclick="toggleSidebar()">âœ•</button>
    </div>

    <div class="sb-item" onclick="go(4); toggleSidebar()">ğŸ  Dashboard</div>
    <div class="sb-item" onclick="openProfileEdit(); toggleSidebar()">ğŸ‘¤ Edit Profile</div>
    <div class="sb-item" onclick="toggleSidebar(); doLogout()">ğŸšª Logout</div>
  </div>
</div>

<div id="sidebar-overlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>
<!-- NAVBAR -->
<nav>
  <div class="logo" onclick="go(1)"><div class="logo-dot"></div>KeralaSeva AI</div>
  <div id="nav-r"></div>
</nav>

<!-- PAGE 1: LANDING -->
<div id="p1" class="pg">
  <div class="pw">
    <div class="hero">
      <div class="hero-bg"></div><div class="hero-grid"></div>
      <div class="hero-l">
        <div class="hero-pill">ğŸ‡®ğŸ‡³ Kerala's AI Scholarship Navigator</div>
        <h1 class="hero-title">Find Your Perfect<br><span class="acc">Scholarship</span><br>In Minutes</h1>
        <p class="hero-desc">KeralaSeva AI matches you with state &amp; central government scholarships â€” filtered by community, income, education level, and district.</p>
        <div class="hero-acts">
          <button class="btn btn-gold" onclick="go(3)">ğŸš€ Get Started Free</button>
          <button class="btn btn-ghost" onclick="go(2)">Browse All Scholarships</button>
        </div>
      </div>
      <div class="hero-r">
        <div class="card-stack">
          <div class="fc"><div class="fc-cat">ğŸ’¡ AI Matched</div><div class="fc-name">CH Muhammed Koya Scholarship</div><div class="fc-amt">â‚¹5,000 â€“ â‚¹12,000</div><div class="fc-meta">ğŸ“… Nov 30 Â· 11 days left</div><div class="fc-bar"><div class="fc-fill" style="width:85%"></div></div></div>
          <div class="fc"><div class="fc-cat">ğŸ›ï¸ Central Govt</div><div class="fc-name">Post Matric Scholarship for Minorities</div><div class="fc-amt">â‚¹7,000 â€“ â‚¹12,000</div><div class="fc-meta">ğŸ“… Oct 15 Â· 47 days left</div><div class="fc-bar"><div class="fc-fill" style="width:55%"></div></div></div>
          <div class="fc"><div class="fc-cat">â­ High Value</div><div class="fc-name">Merit-cum-Means Scholarship</div><div class="fc-amt">â‚¹20,000 â€“ â‚¹30,000</div><div class="fc-meta">ğŸ“… Sep 30 Â· Open</div><div class="fc-bar"><div class="fc-fill" style="width:30%"></div></div></div>
        </div>
      </div>
    </div>
    <div class="stats-strip">
      <div><div class="stat-n">25+</div><div class="stat-l">Active Scholarships</div></div>
      <div><div class="stat-n">â‚¹30,000</div><div class="stat-l">Max Award Value</div></div>
      <div><div class="stat-n">14</div><div class="stat-l">Districts Covered</div></div>
      <div><div class="stat-n">5 min</div><div class="stat-l">To Get Matched</div></div>
    </div>
    <div class="sec">
      <div style="text-align:center"><div class="sec-label">Why KeralaSeva AI</div><h2 class="sec-title">Built for Every Kerala Student</h2><p class="sec-sub" style="margin:14px auto 0">No confusing portals. Just clear, personalized scholarship guidance powered by AI.</p></div>
      <div class="feat-grid">
        <div class="feat-c"><div class="feat-ico">ğŸ¤–</div><div class="feat-title">AI-Powered Matching</div><p class="feat-desc">The backend runs a SQL matching function filtering by your community, income, gender, education level, and district â€” returning only scholarships you're truly eligible for.</p></div>
        <div class="feat-c"><div class="feat-ico">â°</div><div class="feat-title">Deadline Alerts</div><p class="feat-desc">Never miss a closing date. Scholarships due within 14 days appear in a red urgent alert section. A daily background job also sends you email notifications.</p></div>
        <div class="feat-c"><div class="feat-ico">ğŸ“‹</div><div class="feat-title">Step-by-Step Guidance</div><p class="feat-desc">Every scholarship has a numbered application guide and a full document checklist â€” so you know exactly what to prepare before visiting the portal.</p></div>
        <div class="feat-c"><div class="feat-ico">ğŸ”’</div><div class="feat-title">Secure by Design</div><p class="feat-desc">Built on Supabase with Row-Level Security. Your profile is only visible to you â€” no other user can access your data, even with a valid token.</p></div>
        <div class="feat-c"><div class="feat-ico">ğŸŒ</div><div class="feat-title">All Schemes, One Place</div><p class="feat-desc">25+ schemes from State Welfare, Minority, SC/ST, OBC, and Central Government aggregated and kept up to date in one dashboard.</p></div>
        <div class="feat-c"><div class="feat-ico">â†—ï¸</div><div class="feat-title">Direct Official Links</div><p class="feat-desc">Every detail page has an "Apply on Official Portal" button that opens the real government website â€” dcescholarship.kerala.gov.in or scholarships.gov.in.</p></div>
      </div>
    </div>
    <div class="sec how-bg" style="padding:100px 80px">
      <div style="text-align:center;position:relative;z-index:1">
        <div class="sec-label">Simple Process</div>
        <h2 class="sec-title" style="color:#fff">How It Works</h2>
        <p class="sec-sub" style="color:rgba(255,255,255,.55);margin:14px auto 0">From signup to scholarship application in four steps.</p>
      </div>
      <div class="steps-grid">
        <div class="step"><div class="step-n">1</div><div class="step-t">Create Account</div><p class="step-d">Sign up with email + password. The backend registers you in Supabase Auth.</p></div>
        <div class="step"><div class="step-n">2</div><div class="step-t">Build Profile</div><p class="step-d">Enter community, income, education, district. Saved to your profile in the database.</p></div>
        <div class="step"><div class="step-n">3</div><div class="step-t">Get Matched</div><p class="step-d">AI runs eligibility filtering on all 25+ schemes and shows only the ones you qualify for.</p></div>
        <div class="step"><div class="step-n">4</div><div class="step-t">Apply with Ease</div><p class="step-d">Follow the step-by-step guide and click Apply to open the official government portal.</p></div>
      </div>
    </div>
  </div>
  <footer><div class="foot-logo">KeralaSeva AI</div><div class="foot-copy">Â© 2026 KeralaSeva AI Â· Data sourced from official government portals</div></footer>
</div>

<!-- PAGE 2: ALL SCHOLARSHIPS -->
<div id="p2" class="pg">
  <div class="pw">
    <div class="ph"><div class="ph-bg"></div><div class="ph-inner">
      <div class="sec-label">ğŸ“š Scholarship Directory</div>
      <h1 class="ph-title">Kerala Scholarship Directory 2026</h1>
      <p class="ph-sub">Browse all active government scholarship schemes. Sign in to see only the ones you're eligible for.</p>
    </div></div>
    <div class="p2-main">
      <!-- SEARCH BAR -->
<div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:24px">
  <input id="search-keyword" class="fi" placeholder="Search by keyword (e.g. Minority, SC, Engineering)" style="flex:1;min-width:200px">

  <select id="search-community" class="fs">
    <option value="">All Communities</option>
    <option>SC</option>
    <option>ST</option>
    <option>SC/ST</option>
    <option>OBC</option>
    <option>Minority</option>
    <option>General</option>
  </select>

  <select id="search-gender" class="fs">
    <option value="">All Genders</option>
    <option>Male</option>
    <option>Female</option>
  </select>

  <select id="search-education" class="fs">
    <option value="">All Education Levels</option>
    <option>School</option>
    <option>Degree</option>
    <option>PG</option>
    <option>PhD</option>
    <option>Engineering</option>
  </select>

  <input id="search-income" type="number" class="fi" placeholder="Max Income â‚¹" style="max-width:150px">

  <button class="btn btn-forest btn-sm" onclick="runSearch()">Search</button>
</div>
      <div class="filt-bar">
        <span style="font-size:13px;font-weight:600;color:var(--muted);margin-right:4px">Filter:</span>
        <button class="fb on" onclick="p2filt('All',this)">All</button>
        <button class="fb" onclick="p2filt('Minority',this)">Minority</button>
        <button class="fb" onclick="p2filt('Central Govt',this)">Central Govt</button>
        <button class="fb" onclick="p2filt('State Govt',this)">State Govt</button>
        <button class="fb" onclick="p2filt('OBC',this)">OBC</button>
        <button class="fb" onclick="p2filt('SC/ST',this)">SC/ST</button>
      </div>
      <div id="p2-grid" class="s-grid"><div style="grid-column:1/-1"><div class="spin-wrap"><div class="spin"></div><div class="spin-txt">Loading scholarshipsâ€¦</div></div></div></div>
      <div class="cta-block">
        <div class="cta-l"><h2>See Your Personal Matches</h2><p>Create a free profile and our AI instantly shows scholarships filtered exactly to your community, income, education level, and district.</p></div>
        <div class="cta-r">
          <button class="cta-btn cta-gold" onclick="go(3)">ğŸš€ Get Started Free</button>
          <button class="cta-btn cta-ghost" onclick="go(3,'login')">ğŸ”‘ Sign In to My Account</button>
        </div>
      </div>
    </div>
  </div>
  <footer><div class="foot-logo">KeralaSeva AI</div><div class="foot-copy">Â© 2026 KeralaSeva AI Â· Data sourced from official government portals</div></footer>
</div>

<!-- PAGE 3: AUTH -->
<div id="p3" class="pg">
  <div class="pw">
    <div class="auth-wrap">
      <div class="auth-l">
        <div class="auth-l-bg"></div>
        <div class="auth-l-in">
          <h2>Your <span class="g">Scholarship</span><br>Journey Starts Here</h2>
          <p>Join Kerala students who found and applied for scholarships through KeralaSeva AI.</p>
          <div class="ben"><div class="ben-ico">ğŸ¤–</div><div class="ben-txt">AI-matched scholarships tailored to your exact eligibility profile</div></div>
          <div class="ben"><div class="ben-ico">â°</div><div class="ben-txt">Deadline alerts so you never miss a closing application</div></div>
          <div class="ben"><div class="ben-ico">ğŸ“‹</div><div class="ben-txt">Full document checklists and step-by-step application guides</div></div>
          <div class="ben"><div class="ben-ico">ğŸŒ</div><div class="ben-txt">25+ government schemes: State, Central, Minority, SC/ST and more</div></div>
          <div class="auth-quote">
            <p>"I found 7 scholarships I was eligible for within minutes. The document checklist saved me so much time!"</p>
            <cite>â€” Fatima K., Malappuram Â· Degree Student</cite>
          </div>
        </div>
      </div>
      <div class="auth-r">
        <div class="auth-box">
          <div class="tabs-wrap">
            <button class="atab on" id="tab-s" onclick="authTab('signup')">Create Account</button>
            <button class="atab" id="tab-l" onclick="authTab('login')">Sign In</button>
          </div>
          <div id="auth-msg"></div>

          <!-- SIGNUP FORM -->
          <form id="form-s" onsubmit="doSignup(event)">
            <div class="fsec">Personal Details</div>
            <div class="fg"><label class="fl">Full Name</label><input class="fi" name="name" placeholder="e.g. Fatima Khan" required/></div>
            <div class="frow">
              <div class="fg"><label class="fl">Community</label>
                <select class="fs" name="community" required><option value="">Select</option><option>Muslim</option><option>SC</option><option>ST</option><option>SC/ST</option><option>OBC</option><option>SC/OBC</option><option>General</option><option>Minority</option></select></div>
              <div class="fg"><label class="fl">Gender</label>
                <select class="fs" name="gender" required><option value="">Select</option><option>Male</option><option>Female</option><option>Other</option></select></div>
            </div>
            <div class="frow">
              <div class="fg"><label class="fl">Education Level</label>
                <select class="fs" name="education_level" required><option value="">Select</option><option>School</option><option>PostMatric</option><option>Diploma</option><option>Degree</option><option>PG</option><option>PhD</option><option>Professional</option><option>Engineering</option><option>Technical</option></select></div>
              <div class="fg"><label class="fl">Annual Income (â‚¹)</label><input class="fi" name="income" type="number" placeholder="e.g. 180000" min="0" required/></div>
            </div>
            <div class="fg"><label class="fl">District</label>
              <select class="fs" name="district" required><option value="">Select District</option><option>Thiruvananthapuram</option><option>Kollam</option><option>Pathanamthitta</option><option>Alappuzha</option><option>Kottayam</option><option>Idukki</option><option>Ernakulam</option><option>Thrissur</option><option>Palakkad</option><option>Malappuram</option><option>Kozhikode</option><option>Wayanad</option><option>Kannur</option><option>Kasaragod</option></select></div>
            <div class="fsec">Account Credentials</div>
            <div class="fg"><label class="fl">Email Address</label><input class="fi" name="email" type="email" placeholder="your@email.com" required/></div>
            <div class="fg"><label class="fl">Password</label><input class="fi" name="password" type="password" placeholder="Min. 8 characters" minlength="8" required/></div>
            <button class="sub-btn" type="submit" id="btn-s">
              <span id="s-txt">Create Account &amp; Get Matched â†’</span>
              <div class="b-spin" id="s-spin"></div>
            </button>
          </form>

          <!-- LOGIN FORM -->
          <form id="form-l" onsubmit="doLogin(event)" style="display:none">
            <div style="height:10px"></div>
            <div class="fg"><label class="fl">Email Address</label><input class="fi" name="email" type="email" placeholder="your@email.com" required/></div>
            <div class="fg"><label class="fl">Password</label><input class="fi" name="password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required/></div>
            <button class="sub-btn" type="submit" id="btn-l">
              <span id="l-txt">Sign In to My Account â†’</span>
              <div class="b-spin" id="l-spin"></div>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- PAGE 4: MY SCHOLARSHIPS -->
<div id="p4" class="pg">
  <div class="pw">
    <div class="my-hero">
      <div class="my-hero-bg"></div>
      <div class="my-hero-in">
        <div>
          <div class="sec-label">âœ¨ Personalized for You</div>
          <h1>Your Scholarship <span class="acc">Matches</span></h1>
          <p>AI-matched to your profile. Urgent deadlines are highlighted â€” apply before it's too late.</p>
        </div>
        <div class="my-stat"><div class="ms-n" id="mc">â€”</div><div class="ms-l">Matched for You</div></div>
      </div>
    </div>
    <div class="p4-main">
      <div id="p4-msg"></div>
      <div id="p4-body"><div class="spin-wrap"><div class="spin"></div><div class="spin-txt">Finding your matchesâ€¦</div></div></div>
    </div>
  </div>
  <footer><div class="foot-logo">KeralaSeva AI</div><div class="foot-copy">Â© 2026 KeralaSeva AI Â· Data sourced from official government portals</div></footer>
</div>

<!-- PAGE 5: DETAIL -->
<div id="p5" class="pg">
  <div class="pw">
    <div class="p5-main">
      <div id="p5-body"><div class="spin-wrap"><div class="spin"></div></div></div>
    </div>
  </div>
  <footer><div class="foot-logo">KeralaSeva AI</div><div class="foot-copy">Â© 2026 KeralaSeva AI Â· Data sourced from official government portals</div></footer>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â• JAVASCRIPT â•â•â•â•â•â•â•â•â•â•â• -->
<script>
function toggleChat() {
  const box = document.getElementById("chatbox");
  box.style.display = box.style.display === "flex" ? "none" : "flex";
}

function addMessage(text, sender) {
  const container = document.getElementById("chat-messages");
  const msg = document.createElement("div");
  msg.classList.add("chat-message");
  msg.classList.add(sender === "user" ? "chat-user" : "chat-ai");
  msg.innerHTML = text;
  container.appendChild(msg);
  container.scrollTop = container.scrollHeight;
}

async function sendChat() {
  const input = document.getElementById("chat-input");
  const message = input.value.trim();
  if (!message) return;

  addMessage(message, "user");
  input.value = "";

  addMessage("Typing...", "ai");

  try {
    const res = await fetch("/api/chat", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        ...(token && { "Authorization": "Bearer " + token })
      },
      body: JSON.stringify({ message })
    });

    const data = await res.json();

    document.querySelector("#chat-messages .chat-ai:last-child")?.remove();

    addMessage(data.reply || "No response.", "ai");

  } catch (err) {
    addMessage("Error connecting to server.", "ai");
  }
}
  /* â”€â”€ SIDEBAR TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('open');
  document.getElementById('sidebar-overlay').classList.toggle('show');
}
/* â”€â”€ CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const API = '/api';

/* â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let token = localStorage.getItem('ks_token') || null;
let userEmail = localStorage.getItem('ks_email') || '';
let allSchols = [];   // cache for page 2

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ROUTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function go(page, authMode) {
  if ((page === 4 || page === 5) && !token) { go(3); return; }
  document.querySelectorAll('.pg').forEach(p => p.classList.remove('on'));
  document.getElementById('p' + page).classList.add('on');
  window.scrollTo({ top: 0, behavior: 'smooth' });
  renderNav(page);
  if (page === 2) initP2();
  if (page === 3 && authMode) authTab(authMode);
  if (page === 3) {
  document.getElementById('form-s')?.reset();
  document.getElementById('form-l')?.reset();
  clearMsg('auth-msg');
}
  if (page === 4) initP4();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderNav(activePage) {
  const r = document.getElementById('nav-r');
  if (token) {
    r.innerHTML = `
      <div style="display:flex;align-items:center;gap:16px">
        <div class="menu-icon" onclick="toggleSidebar()">â˜°</div>
        <span class="nl${activePage===1?' on':''}" onclick="go(1)">Home</span>
        <span class="nl${activePage===2?' on':''}" onclick="go(2)">Scholarships</span>
        <span class="nl${activePage===4?' on':''}" onclick="go(4)">My Matches</span>
      </div>`;
  }else{
    r.innerHTML = `
      <span class="nl${activePage===1?' on':''}" onclick="go(1)">Home</span>
      <span class="nl${activePage===2?' on':''}" onclick="go(2)">Scholarships</span>
      <span class="nl${activePage===3?' on':''}" onclick="go(3)">Sign In</span>
      <span class="nl-cta" onclick="go(3)">Get Started</span>`;
  }
}

function doLogout() {
  fetch(`${API}/auth/logout`, { method: 'POST',
    headers: { Authorization: `Bearer ${token}` } }).catch(() => {});
  localStorage.removeItem('ks_token');
  localStorage.removeItem('ks_email');
  token = null; userEmail = '';
  allSchols = [];
  go(1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTILITIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function daysLeft(d)  { return Math.ceil((new Date(d) - new Date()) / 86400000); }
function fmtDate(d)   { return new Date(d).toLocaleDateString('en-IN', {day:'numeric',month:'short',year:'numeric'}); }
function fmtAmt(a, b) {
  const f = n => 'â‚¹' + Number(n).toLocaleString('en-IN');
  if (!a && !b) return 'Varies';
  return (a && b) ? `${f(a)} â€“ ${f(b)}` : f(a || b);
}
function guessCategory(name = '') {
  const n = name.toLowerCase();
  if (/\bsc\b|\bst\b|dalit/.test(n)) return 'SC/ST';
  if (/obc/.test(n)) return 'OBC';
  if (/minority|muslim|koya|kalam/.test(n)) return 'Minority';
  if (/central|national|merit-cum/.test(n)) return 'Central Govt';
  return 'State Govt';
}
function showMsg(elId, txt, type='err') {
  const icons = {ok:'âœ…',err:'âš ï¸',inf:'â„¹ï¸',wrn:'âš ï¸'};
  document.getElementById(elId).innerHTML =
    `<div class="msg msg-${type}">${icons[type]} ${txt}</div>`;
}
function clearMsg(elId) { document.getElementById(elId).innerHTML = ''; }
function setLoad(prefix, on) {
  document.getElementById(`${prefix}-txt`).style.opacity = on ? '0' : '1';
  document.getElementById(`${prefix}-spin`).style.display = on ? 'block' : 'none';
  document.getElementById(`btn-${prefix}`).disabled = on;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 2 â€” ALL SCHOLARSHIPS
   GET /api/scholarships/  (requires token)
   Uses fallback static data if not logged in
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function runSearch() {
  const keyword   = document.getElementById('search-keyword').value;
  const community = document.getElementById('search-community').value;
  const gender    = document.getElementById('search-gender').value;
  const education = document.getElementById('search-education').value;
  const income    = document.getElementById('search-income').value;

  const params = new URLSearchParams();

  if (keyword)   params.append('search', keyword);
  if (community) params.append('community', community);
  if (gender)    params.append('gender', gender);
  if (education) params.append('education', education);
  if (income)    params.append('income', income);

  const res = await fetch(`${API}/scholarships?${params.toString()}`, {
    headers: token ? { Authorization: `Bearer ${token}` } : {}
  });

  const data = await res.json();
  allSchols = data.scholarships || [];
  renderP2(allSchols);
}
async function initP2() {
  if (allSchols.length) { renderP2(allSchols); return; }
  try {
    const headers = token ? { Authorization: `Bearer ${token}` } : {};
    const res = await fetch(`${API}/scholarships/`, { headers });
    if (!res.ok) throw new Error();
    const data = await res.json();
    allSchols = data.scholarships || [];
  } catch {
    allSchols = FALLBACK;
  }
  renderP2(allSchols);
}

function p2filt(cat, btn) {
  document.querySelectorAll('.fb').forEach(b => b.classList.remove('on'));
  btn.classList.add('on');
  const list = cat === 'All' ? allSchols : allSchols.filter(s => guessCategory(s.name) === cat);
  renderP2(list);
}

function renderP2(list) {
  const g = document.getElementById('p2-grid');
  if (!list.length) { g.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:80px 20px;color:var(--muted)">No scholarships found.</div>`; return; }
  g.innerHTML = list.map(s => {
    const days = daysLeft(s.deadline);
    const urg = days >= 0 && days <= 14;
    const exp = days < 0;
    const dlTxt = exp ? 'ğŸ”´ Expired' : urg ? `âš ï¸ ${days} days left` : `ğŸ“… ${fmtDate(s.deadline)}`;
    const cat = guessCategory(s.name);
    return `<div class="s-card" onclick="token ? openDetail('${s.id || s.scholarship_id}') : go(3)">
      <div class="sc-cat">${cat}</div>
      <div class="sc-name">${s.name}</div>
      <div class="sc-amt">${fmtAmt(s.amount_min, s.amount_max)}</div>
      <div class="sc-foot">
        <span class="sc-dl${urg?' soon':''}">${dlTxt}</span>
        <span class="tag ${urg?'t-red':exp?'t-muted':'t-sage'}">${urg?'âš ï¸ Closing soon':exp?'Expired':'âœ… Open'}</span>
      </div>
    </div>`;
  }).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 3 â€” AUTH
   SIGNUP FLOW (3 steps):
     1. POST /api/auth/signup  â†’ gets user_id (NO token yet)
     2. POST /api/auth/login   â†’ gets access_token
     3. POST /api/profile/create (with token) â†’ saves profile to DB
   LOGIN FLOW:
     1. POST /api/auth/login   â†’ gets access_token
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function authTab(mode) {
  document.getElementById('tab-s').classList.toggle('on', mode === 'signup');
  document.getElementById('tab-l').classList.toggle('on', mode === 'login');
  document.getElementById('form-s').style.display = mode === 'signup' ? '' : 'none';
  document.getElementById('form-l').style.display  = mode === 'login'  ? '' : 'none';
  clearMsg('auth-msg');
  document.getElementById('form-s')?.reset();
  document.getElementById('form-l')?.reset();
  document.getElementById('s-txt').textContent = "Create Account & Get Matched â†’";
}
async function doSignup(event) {
    event.preventDefault();

    clearMsg('auth-msg');
    setLoad('s', true);

    const form = event.target;
    const fd = new FormData(form);
    const data = Object.fromEntries(fd.entries());

    try {
        // ğŸ”¹ STEP 1: SIGNUP
        const signupRes = await fetch("/api/auth/signup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                email: data.email,
                password: data.password,
                name: data.name,
                community: data.community,
                gender: data.gender,
                education_level: data.education_level,
                income: parseInt(data.income),
                district: data.district
            })
        });

        const signupData = await signupRes.json();

        if (!signupRes.ok) {
            throw new Error(signupData.error || "Signup failed");
        }

        // ğŸ”¹ STEP 2: AUTO LOGIN
        const loginRes = await fetch("/api/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                email: data.email,
                password: data.password
            })
        });

        const loginData = await loginRes.json();

        if (!loginRes.ok) {
            throw new Error(loginData.error || "Login after signup failed");
        }

        // ğŸ”¹ STORE TOKEN
        localStorage.setItem("ks_token", loginData.access_token);
        localStorage.setItem("ks_email", loginData.user?.email || data.email);

        token = loginData.access_token;
        userEmail = loginData.user?.email || data.email;

        showMsg('auth-msg', "Account created successfully! Redirectingâ€¦", "ok");

        setTimeout(() => {
            go(4);
        }, 800);

    } catch (error) {
        showMsg('auth-msg', error.message || "Something went wrong.", "err");
    } finally {
        setLoad('s', false);
    }
}

async function doLogin(e) {
  e.preventDefault();
  clearMsg('auth-msg');
  setLoad('l', true);
  const fd = new FormData(e.target);
  const p = Object.fromEntries(fd);

  try {
    // POST /api/auth/login â†’ { access_token, refresh_token, user }
    const res = await fetch(`${API}/auth/login`, {
      method: 'POST', headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email: p.email, password: p.password })
    });
    const data = await res.json();
    if (!res.ok) throw new Error(data.error || 'Login failed');

    token = data.access_token;
    userEmail = data.user?.email || p.email;
    localStorage.setItem('ks_token', token);
    localStorage.setItem('ks_email', userEmail);

    showMsg('auth-msg', 'Login successful! Redirectingâ€¦', 'ok');
    setTimeout(() => go(4), 800);

  } catch (err) {
    showMsg('auth-msg', err.message || 'Login failed. Check your credentials.', 'err');
  } finally {
    setLoad('l', false);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 4 â€” MY MATCHES
   GET /api/scholarships/matching
   Calls the SQL function get_matching_scholarships(user_id)
   which filters by: income + community + gender + education_level
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function initP4() {
  document.getElementById('p4-body').innerHTML = `<div class="spin-wrap"><div class="spin"></div><div class="spin-txt">Finding your matchesâ€¦</div></div>`;
  document.getElementById('mc').textContent = 'â€”';
  clearMsg('p4-msg');

  try {
    const res = await fetch(`${API}/scholarships/matching`, {
      headers: { Authorization: `Bearer ${token}` }
    });

    // 401 = token expired â†’ force re-login
    if (res.status === 401) { doLogout(); return; }

    const data = await res.json();

    // 404 = profile not yet created (can happen if profile save failed)
    if (res.status === 404) {
      showMsg('p4-msg', 'Your profile is incomplete. <strong>Update your profile</strong> to see personalized matches.', 'wrn');
    }

    const list = data.scholarships || [];
    document.getElementById('mc').textContent = list.length;

    if (!list.length) {
      document.getElementById('p4-body').innerHTML = `<div class="empty">
        <div class="empty-ico">ğŸ”</div>
        <h3>No matches yet</h3>
        <p>We couldn't find scholarships for your current profile. Try updating your community, education level, or income.</p>
      </div>`;
    } else {
      renderP4(list);
    }

  } catch {
    document.getElementById('p4-body').innerHTML = `<div class="empty">
      <div class="empty-ico">âš¡</div>
      <h3>Could not reach server</h3>
      <p>Make sure your Flask backend is running at <strong>localhost:5000</strong>.</p>
      <button class="btn btn-forest" onclick="initP4()">Retry</button>
    </div>`;
  }
}

function renderP4(list) {
  const urgent   = list.filter(s => { const d = daysLeft(s.deadline); return d >= 0 && d <= 14; });
  const normal   = list.filter(s => daysLeft(s.deadline) > 14);
  const expired  = list.filter(s => daysLeft(s.deadline) < 0);

  let html = '';

  // Red urgent section (only if any scholarships closing within 14 days)
  if (urgent.length) {
    html += `<div class="urg-sec">
      <div class="urg-hd">
        <span class="tag t-urg">ğŸ”´ URGENT</span>
        <div class="urg-title">Approaching Deadlines â€” Apply Immediately!</div>
      </div>
      <div class="urg-row">
        ${urgent.map(s => {
          const id = s.scholarship_id || s.id;
          const d = daysLeft(s.deadline);
          return `<div class="urg-card">
            <div>
              <div class="uc-name">${s.name}</div>
              <div class="uc-days">â³ ${d === 0 ? 'Due today!' : d + ' days left'}</div>
            </div>
            <button class="btn btn-red btn-sm" onclick="openDetail('${id}')">View â†’</button>
          </div>`;
        }).join('')}
      </div>
    </div>`;
  }

  // Full sorted list: urgent first, then normal, then expired
  html += `<div class="list-hd">
    <div class="list-title">All Matched Scholarships</div>
    <span class="count-pill">${list.length} found</span>
  </div>
  <div class="s-list">
    ${[...urgent, ...normal, ...expired].map(s => {
      const id = s.scholarship_id || s.id;
      const d = daysLeft(s.deadline);
      const cat = guessCategory(s.name);
      const dlClass = d < 0 ? '' : d <= 7 ? ' urg' : d <= 14 ? ' soon' : '';
      const dlTxt = d < 0 ? 'ğŸ”´ Deadline passed'
        : d === 0 ? 'ğŸ”´ Due today!'
        : d <= 7  ? `ğŸ”´ ${d} days left`
        : d <= 14 ? `âš ï¸ ${d} days left`
        : `ğŸ“… ${fmtDate(s.deadline)} Â· ${d} days`;
      return `<div class="s-row" onclick="openDetail('${id}')">
        <div>
          <div class="sr-cat">${cat}</div>
          <div class="sr-name">${s.name}</div>
          <div class="sr-meta">
            <span class="sr-amt">${fmtAmt(s.amount_min, s.amount_max)}</span>
            <span class="sr-dl${dlClass}">${dlTxt}</span>
          </div>
        </div>
        <div class="sr-tags">
          ${s.income_limit ? `<span class="tag t-muted">â‰¤ â‚¹${Number(s.income_limit).toLocaleString('en-IN')}</span>` : ''}
          <span class="tag t-sage">âœ“ Eligible</span>
        </div>
        <button class="btn btn-outline btn-sm" onclick="event.stopPropagation();openDetail('${id}')">Details â†’</button>
      </div>`;
    }).join('')}
  </div>`;

  document.getElementById('p4-body').innerHTML = html;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE 5 â€” SCHOLARSHIP DETAIL
   GET /api/scholarships/<id>
   Returns: { scholarship, eligibility[], documents_required[], application_steps[] }
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function openDetail(id) {
  // Switch to detail page immediately with a spinner
  document.getElementById('p5-body').innerHTML = `<div class="spin-wrap"><div class="spin"></div><div class="spin-txt">Loading scholarship detailsâ€¦</div></div>`;
  go(5);

  try {
    const res = await fetch(`${API}/scholarships/${id}`, {
      headers: { Authorization: `Bearer ${token}` }
    });
    if (res.status === 401) { doLogout(); return; }
    if (!res.ok) throw new Error('Not found');
    const data = await res.json();
    renderDetail(data);
  } catch {
    document.getElementById('p5-body').innerHTML = `
      <button class="back-btn" onclick="go(4)">â† Back</button>
      <div class="empty"><div class="empty-ico">âš¡</div>
        <h3>Could not load details</h3>
        <p>Make sure your Flask backend is running at <strong>localhost:5000</strong>.</p>
        <button class="btn btn-forest" onclick="go(4)">Go Back</button>
      </div>`;
  }
}

function renderDetail(data) {
  const s    = data.scholarship || {};
  const elig = data.eligibility || [];
  const docs = data.documents_required || [];
  const stps = data.application_steps || [];
  const cat  = guessCategory(s.name);
  const d    = daysLeft(s.deadline);
  const urg  = d >= 0 && d <= 14;

  const stepsHtml = stps.length
    ? stps.map(st => `<li class="step-r">
        <div class="step-c">${st.step_number}</div>
        <div class="step-txt">${st.step_text}</div>
      </li>`).join('')
    : '<p style="color:var(--muted);font-size:14px;padding:16px 0">No application steps listed.</p>';

  const docsHtml = docs.length
    ? docs.map(dc => `<div class="doc-item"><span style="font-size:18px">ğŸ“„</span><div class="doc-name">${dc.document_name}</div></div>`).join('')
    : '<p style="color:var(--muted);font-size:14px">No documents listed.</p>';

  const eligHtml = elig.length
    ? elig.map(e => `<div class="elig-chip"><div class="elig-row">
        <div><div class="ef-l">Community</div><div class="ef-v">${e.community}</div></div>
        <div><div class="ef-l">Gender</div><div class="ef-v">${e.gender}</div></div>
        <div><div class="ef-l">Education</div><div class="ef-v">${e.education_level}</div></div>
      </div></div>`).join('')
    : '<p style="color:var(--muted);font-size:14px">Open to all eligible applicants.</p>';

  document.getElementById('p5-body').innerHTML = `
    <button class="back-btn" onclick="go(4)">â† Back to My Scholarships</button>
    <div class="crumb">
      <span class="crumb-lnk" onclick="go(1)">Home</span><span class="crumb-sep">/</span>
      <span class="crumb-lnk" onclick="go(4)">My Scholarships</span><span class="crumb-sep">/</span>
      <span class="crumb-cur">${s.name}</span>
    </div>

    <!-- HEADER CARD -->
    <div class="det-hdr">
      <div class="dh-l">
        <div class="dh-cat">${cat}</div>
        <h1 class="dh-title">${s.name}</h1>
        <p class="dh-desc">${s.description || ''}</p>
        ${urg ? `<div class="dh-urg">âš ï¸ Only ${d === 0 ? 'TODAY is the last day' : d + ' days left'}! Apply immediately.</div>` : ''}
      </div>
      <div class="dh-amt">
        <div class="da-l">Award Amount</div>
        <div class="da-v">${fmtAmt(s.amount_min, s.amount_max)}</div>
        <div class="da-dl">ğŸ“… Deadline: ${fmtDate(s.deadline)}</div>
        <div class="da-inc">Income limit: â‚¹${Number(s.income_limit || 0).toLocaleString('en-IN')}</div>
      </div>
    </div>

    <!-- DETAIL GRID -->
    <div class="det-grid">
      <!-- LEFT: Steps + Eligibility -->
      <div>
        <div class="d-card">
          <div class="dc-hd"><div class="dc-ico">ğŸ“</div><div class="dc-lbl">How to Apply</div></div>
          <ol class="step-list">${stepsHtml}</ol>
        </div>
        <div class="d-card">
          <div class="dc-hd"><div class="dc-ico">âœ…</div><div class="dc-lbl">Eligibility Criteria</div></div>
          <div class="elig-list">
            ${eligHtml}
            <div class="inc-tag">ğŸ’° Annual family income must be â‰¤ â‚¹${Number(s.income_limit || 0).toLocaleString('en-IN')}</div>
          </div>
        </div>
      </div>
      <!-- RIGHT: Documents -->
      <div class="d-card">
        <div class="dc-hd"><div class="dc-ico">ğŸ“</div><div class="dc-lbl">Documents Required</div></div>
        <div class="doc-list">${docsHtml}</div>
        <div class="doc-tip">ğŸ’¡ <strong>Tip:</strong> Scan documents at 200 DPI minimum. Most portals accept PDF or JPG under 2 MB per file.</div>
      </div>
    </div>

    <!-- APPLY BANNER -->
    <div class="apply-bar">
      <div class="ab-l">
        <h3>Ready to Apply?</h3>
        <p>Click the button to open the official government scholarship portal in a new tab. Have all scanned documents ready â€” the application takes about 15â€“20 minutes.</p>
      </div>
      <button class="apply-btn" onclick="window.open('${s.portal_url || 'https://scholarships.gov.in'}','_blank')">
        Apply on Official Portal â†—
      </button>
    </div>
  `;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FALLBACK STATIC DATA
   (shown if backend is unreachable on page 2)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const FALLBACK = [
  {id:'1',name:'CH Muhammed Koya Scholarship',deadline:'2025-11-30',income_limit:200000,amount_min:5000,amount_max:12000},
  {id:'2',name:'APJ Abdul Kalam Scholarship',deadline:'2025-10-31',income_limit:200000,amount_min:6000,amount_max:10000},
  {id:'3',name:'Merit-cum-Means Scholarship',deadline:'2025-09-30',income_limit:250000,amount_min:20000,amount_max:30000},
  {id:'4',name:'Post Matric Scholarship for Minorities',deadline:'2026-10-15',income_limit:200000,amount_min:7000,amount_max:12000},
  {id:'5',name:'Kerala OBC Pre-Matric Scholarship',deadline:'2026-01-31',income_limit:300000,amount_min:4000,amount_max:8000},
  {id:'6',name:'SC/ST Higher Education Scholarship',deadline:'2026-06-15',income_limit:250000,amount_min:10000,amount_max:25000},
];
async function openProfileEdit() {
  if (!token) {
    go(3);
    return;
  }

  // Open auth page in signup mode
  go(3, 'signup');

  // Change button text
  document.getElementById('s-txt').textContent = "Update Profile â†’";

  try {
    const res = await fetch(`${API}/auth/profile/me`, {
      headers: { Authorization: `Bearer ${token}` }
    });

    if (!res.ok) throw new Error("Failed to load profile");

    const data = await res.json();
    const form = document.getElementById('form-s');

    form.name.value = data.name || '';
    form.community.value = data.community || '';
    form.gender.value = data.gender || '';
    form.education_level.value = data.education_level || '';
    form.income.value = data.income || '';
    form.district.value = data.district || '';

  } catch (err) {
    showMsg('auth-msg', 'Could not load profile.', 'err');
  }
}
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
renderNav(1);
// If already logged in, go straight to matches
if (token) {
  go(4);
} else {
  go(1);
}
document.addEventListener("DOMContentLoaded", function() {

  const toggleBtn = document.getElementById("chat-toggle");
  if (toggleBtn) {
    toggleBtn.onclick = toggleChat;
  }

  const chatInput = document.getElementById("chat-input");
  if (chatInput) {
    chatInput.addEventListener("keypress", function(e) {
      if (e.key === "Enter") {
        sendChat();
      }
    });
  }

});

</script>
<!-- CHATBOT FLOATING WIDGET -->
<div id="chat-toggle">ğŸ’¬</div>

<div id="chatbox">
  <div class="chat-header">
    KeralaSeva AI Assistant
    <span onclick="toggleChat()">âœ•</span>
  </div>

  <div id="chat-messages"></div>

  <div class="chat-input-area">
    <input id="chat-input" placeholder="Ask about your scholarships..." />
    <button onclick="sendChat()">Send</button>
  </div>
</div>
</body>
</html>
